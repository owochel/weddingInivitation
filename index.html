<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wedding Invitation - LinkedIn Style</title>

    <script
      src="https://code.jquery.com/jquery-3.1.1.min.js"
      integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
      crossorigin="anonymous"
    ></script>
    <script src="https://kit.fontawesome.com/3055f91a99.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="styles.css" />
    <!-- <link rel="stylesheet" href="new.css" /> -->
  </head>
  <body>
    <div class="container">
      <div class="linkedin-logo">
        <!-- Linked
        <span
          style="
            color: white;
            background: red;
            padding: 2px 5px;
            border-radius: 50%;
            font-size: 12px;
          "
        >
          2
        </span> -->
        <img class="linkedin-logo" src="logo.png" alt="logo" />
      </div>
      <p>You are invited to witness</p>
      <a href="https://www.linkedin.com/in/shuang-cai/">
        <img src="shuang.jpeg" alt="Couple Photo" class="profile-pic" />
      </a>
      <a href=" https://www.linkedin.com/in/jeffyanchen/">
        <img src="yan.jpeg" alt="Couple Photo" class="profile-pic" />
      </a>
      <h2>Shuang Cai & Yan Chen</h2>
      <p>Future Life Partners</p>
      <div class="button-container">
        <button class="button" id="rsvpButton">Accept</button>
        <button class="outline-button" id="sayCongrats">Say Congrats</button>
      </div>
      <div
        id="messageModal"
        class="ui modal"
        style="
          height: 0;
          overflow: hidden;
          transition: all;
          transition-duration: 1s;
        "
      >
        <i class="close icon"></i>
        <div class="content">
          <div class="p-2 ">
            <input
              type="text"
              id="guestName"
              placeholder="Your Name"
              class="w-40"
              required
            />
            <textarea
              id="guestMessage"
              class="ui input w-80"
              placeholder="Your Message"
              required
            ></textarea>
          </div>

          <button id="modalSubmitMessage" class="ui button">Send</button>
        </div>

        <p id="responseMessage"></p>
        <div class="actions">
          <!-- <button class="ui button" id="modalSubmitMessage">Send</button> -->
          <button class="ui button" id="modalCloseButton">Cancel</button>
        </div>
      </div>
      <div class="people-you-may-know">
        <h3>More people you may know</h3>
        <div class="person">
          <img src="guest1.jpg" alt="Guest 1" />
          <div>
            <p><strong>Melika Panbehchi</strong></p>
            <p>Bridesmaid</p>
          </div>
          <button class="view-button">View Profile</button>
        </div>
        <div class="person">
          <img src="guest2.jpg" alt="Guest 2" />
          <div>
            <p><strong>Baiyuan Xing</strong></p>
            <p>Groomsman</p>
          </div>
          <button class="view-button">View Profile</button>
        </div>
      </div>
    </div>

    <script>
      document
        .getElementById("rsvpButton")
        .addEventListener("click", function () {
          window.location.href =
            "https://calendar.app.google/s8HZxK6FWjHnq3ZE6";
        });

      document
        .getElementById("sayCongrats")
        .addEventListener("click", function () {
          $(".ui.modal").css({ height: "auto" });
        });
    </script>
  </body>
</html>

<div id="comment"></div>

<script src="semantic/dist/semantic.min.js"></script>
<script>
  const URL =
    "https://script.google.com/macros/s/AKfycbx4nIvmHoPreK2A_PyvDJeSyGBfOI7SHVHBOSE0ekmKmtdv5xv4q4AFzSrTxarHtJHP/exec";
  const getLatestDocument = () => {
    fetch(URL, {
      method: "GET",
    })
      .then(async (res) => {
        console.log("Response received:", res);
        if (!res.ok) {
          throw new Error(`HTTP error! Status: ${res.status}`);
        }
        const responseJson = await res.json();
        const message = responseJson.message;
        const data = message.splice(1);
        console.log(data);
        const commentBody = document.getElementById("comment");
        data.forEach((row) => {
          const existingRow = document.getElementById(row[0]);
          if (existingRow) return;
          const tr = document.createElement("div");
          tr.id = row[0];
          row.forEach((cell) => {
            const td = document.createElement("div");
            td.textContent = cell;
            tr.appendChild(td);
          });
          commentBody.appendChild(tr);
        });
      })
      .catch((error) => {
        console.error("Fetch error:", error);
        responseMessage.textContent = "Something went wrong. Check console.";
      });
  };
  getLatestDocument();
  document
    .getElementById("modalSubmitMessage")
    .addEventListener("click", function () {
      getLatestDocument();
      const name = document.getElementById("guestName").value;
      const message = document.getElementById("guestMessage").value;
      const responseMessage = document.getElementById("responseMessage");

      if (name === "" || message === "") {
        responseMessage.textContent = "Please fill in both fields.";
        return;
      }

      console.log("Attempting to send fetch request...");

      fetch(URL, {
        method: "POST",
        mode: "no-cors",
        headers: {
          "Content-Type": "application/json",
          "Access-Control-Allow-Origin": "*",
        },
        body: JSON.stringify({ name: name, message: message }),
      })
        .then((res) => {
          console.log("Response received:", res);
          if (res.status > 200) {
            throw new Error(`HTTP error! Status: ${res.status}`);
          }
        })
        .then((data) => {
          console.log("Success:", data);
          document.getElementById("responseMessage").textContent =
            "Thank you for your message!";
        })
        .catch((error) => {
          console.error("Fetch error:", error);
          document.getElementById("responseMessage").textContent =
            "Something went wrong. Check console.";
        });

      console.log("Fetch request sent.");
    });
</script>
